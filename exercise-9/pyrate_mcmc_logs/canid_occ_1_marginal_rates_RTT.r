# 1 files combined:
# 	/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates.log

# 95% HPDs calculated using code from Biopy (https://www.cs.auckland.ac.nz/~yhel002/biopy/)

pdf(file='/home/eeb177-student/Desktop/eeb-177/lab-work/exercise-9/pyrate_mcmc_logs/canid_occ_1_marginal_rates_RTT.pdf',width=0.6*9, height=16.8)
par(mfrow=c(4,1))
library(scales)
L_hpd_m95=c(0.201689256408, 0.201689256408,0.201689256408,0.201689256408,0.201689256408,0.046349110308,0.0343003543793,0.0397266399719,0.0397266399719,0.0397266399719,0.0397266399719,0.0397266399719,0.0397266399719,0.0397266399719,0.0397266399719,0.0309318694702,0.0541138836134,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0901442396878,0.0886121646071,0.0835560811942,0.0871488460112,0.104582721857,0.160645303548,0.15749377625,0.18160385164,0.18160385164,0.18160385164,0.18160385164,0.18160385164,0.18160385164,0.18160385164,0.18160385164,0.18191444196,0.156140661185,0.149885452738,0.149885452738,0.149885452738,0.1357941105,0.128444839441)
L_hpd_M95=c(0.341030109708, 0.341030109708,0.341030109708,0.341030109708,0.343222228596,0.329132932283,0.181922847159,0.126530162362,0.124850748046,0.123559116447,0.123559116447,0.123559116447,0.123559116447,0.123559116447,0.123559116447,0.128737418647,0.171838717269,0.171838717269,0.171838717269,0.172663277758,0.170561955009,0.170561955009,0.171838717269,0.171494162052,0.170561955009,0.171494162052,0.171838717269,0.171838717269,0.171838717269,0.253991074657,0.345952001191,0.418952320544,0.482101188413,0.474955178781,0.481203119837,0.482101188413,0.481203119837,0.481203119837,0.481203119837,0.481203119837,0.481203119837,0.481203119837,0.482101188413,0.482101188413,0.482101188413,0.482101188413,0.482101188413,0.481203119837,0.474955178781)
M_hpd_m95=c(0.856743714219, 0.856743714219,0.0927879336032,0.0927879336032,0.0927879336032,0.0933425717842,0.096810421461,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0925508666257,0.0916301942218,0.0916301942218,0.0916301942218,0.0601603090643,0.0420707344146,0.0236699715668,0.0309289546723,0.0304907432562,0.0309289546723,0.0309289546723,0.0286609595973,0.0286609595973,0.0329883715115,0.0329883715115,0.0309289546723,0.0309289546723,0.0205616137051,0.0313293559334,0.0263289491384,0.0263289491384,0.0205616137051,0.0296084736356,0.0205616137051,0.0205616137051,0.0205616137051,0.0205616137051,0.0205616137051,0.0205616137051,0.0205616137051)
M_hpd_M95=c(1.49810603849, 1.49810603849,0.15848348395,0.152304439771,0.150575424372,0.149349353925,0.149349353925,0.140869370204,0.140869370204,0.140869370204,0.140869370204,0.140869370204,0.140869370204,0.140869370204,0.140869370204,0.140869370204,0.141146869683,0.141146869683,0.141146869683,0.145102323994,0.147842950107,0.160598706581,0.16392801176,0.16392801176,0.160598706581,0.125196258333,0.120350216405,0.0966250436248,0.0955217976266,0.0955217976266,0.0929557682102,0.0929557682102,0.0983037633134,0.0993302261918,0.0983037633134,0.104556403172,0.111635424369,0.164103059881,0.172253215291,0.197060734819,0.205462315355,0.269458056673,0.306146634453,0.306146634453,0.306146634453,0.306146634453,0.306146634453,0.306146634453,0.306146634453)
R_hpd_m95=c(-1.25054574949, -1.25054574949,0.071782368127,0.071782368127,0.0687499556388,-0.0668551133922,-0.101965160343,-0.0973262160128,-0.0843176576102,-0.0843176576102,-0.0843176576102,-0.0843176576102,-0.0843176576102,-0.0843176576102,-0.0843176576102,-0.0973262160128,-0.0653025392423,-0.0353293836042,-0.0353293836042,-0.0374507987811,-0.0382845119243,-0.0454968161183,-0.0454968161183,-0.0382845119243,-0.0436364786095,-0.00787396531052,0.00110321312202,0.00167320833545,0.00167320833545,0.00167320833545,0.0111482234422,0.0337214653987,0.0608687326249,0.0826817770926,0.0916903107339,0.0915163401163,0.0915163401163,0.0803928378588,0.0444360603013,0.0433340419019,0.0433340419019,0.00881925123256,-0.00402213118583,-0.00402213118583,-0.0132541874256,-0.0132541874256,-0.0390021033965,-0.0718771650196,-0.0718771650196)
R_hpd_M95=c(-0.594143371334, -0.594143371334,0.235766138197,0.235766138197,0.235766138197,0.235766138197,0.071808396866,0.0108564050357,0.0199805844328,0.0186051663642,0.0186051663642,0.0186051663642,0.0186051663642,0.0186051663642,0.0199805844328,0.0238960053383,0.0565319715964,0.0565319715964,0.0569375099066,0.0565319715964,0.0613484668026,0.0565319715964,0.0670328166855,0.0826817770926,0.106243009117,0.120685408795,0.119055235156,0.117453763157,0.117453763157,0.194598464448,0.292065492263,0.359434287664,0.403912738329,0.415723648021,0.415723648021,0.415723648021,0.424258573573,0.415723648021,0.399239409652,0.403912738329,0.415723648021,0.417280522209,0.417280522209,0.439860910883,0.439860910883,0.439860910883,0.415723648021,0.409757567296,0.415723648021)
L_mean=c(0.268414938515, 0.268414938515,0.270115654123,0.270220797733,0.269509913431,0.227331585577,0.089205667511,0.0821383947525,0.0816341601234,0.0807378295239,0.0807378295239,0.0807378295239,0.0807378295239,0.0807378295239,0.0809447098611,0.0852250404816,0.117616170718,0.128204405818,0.128204405818,0.128666094337,0.129558816306,0.129558816306,0.130649300992,0.130517791205,0.130345222394,0.130614739669,0.1306833132,0.1306833132,0.13156765827,0.14088638241,0.179722498791,0.276757478607,0.318955979866,0.31945392962,0.32197304878,0.321358254068,0.319499999984,0.319499999984,0.319900497879,0.321148796201,0.32056639815,0.32021986103,0.325558506939,0.321152448883,0.319016773635,0.319016773635,0.318935147036,0.323890472598,0.325211980335)
M_mean=c(1.13308974621, 1.13308974621,0.123750032834,0.123584288269,0.123734453992,0.121506200274,0.120808224381,0.118982230614,0.118982230614,0.118982230614,0.118982230614,0.118982230614,0.118982230614,0.118982230614,0.118982230614,0.118982230614,0.118833312817,0.118833312817,0.118764678089,0.119869159036,0.121185422185,0.12339151832,0.123177958227,0.120893442149,0.102154830645,0.0719717904261,0.0657920798301,0.0632283775068,0.0632028311877,0.0631083188713,0.0630745533974,0.0630745533974,0.0632867445679,0.0648158160144,0.0658378040432,0.0679695303729,0.0705355717984,0.0742843771521,0.080166416401,0.0882916052646,0.0917235573357,0.107763202427,0.116507409706,0.116507409706,0.116507409706,0.116507409706,0.116507409706,0.116507409706,0.116507409706)
R_mean=c(-0.864674807692, -0.864674807692,0.146365621289,0.146636509464,0.145775459439,0.105825385303,-0.0316025568699,-0.0368438358614,-0.0373480704905,-0.0382444010901,-0.0382444010901,-0.0382444010901,-0.0382444010901,-0.0382444010901,-0.0380375207528,-0.0337571901323,-0.0012171420992,0.00937109300075,0.00943972772908,0.00879693530077,0.00837339412108,0.00616729798588,0.00747134276502,0.00962434905529,0.0281903917482,0.0586429492429,0.0648912333695,0.0674549356928,0.0683648270828,0.0777780635386,0.116647945394,0.213682925209,0.255669235298,0.254638113605,0.256135244737,0.253388723695,0.248964428186,0.245215622832,0.239734081478,0.232857190936,0.228842840814,0.212456658603,0.209051097233,0.204645039177,0.202509363929,0.202509363929,0.20242773733,0.207383062893,0.208704570629)
trans=0.5
age=(0:(49-1))* -1
plot(age,age,type = 'n', ylim = c(0, 0.530311307254), xlim = c(-51.45,2.45), ylab = 'Speciation rate', xlab = 'Ma',main='canid' )
polygon(c(age, rev(age)), c(L_hpd_M95, rev(L_hpd_m95)), col = alpha("#4c4cec",trans), border = NA)
lines(rev(age), rev(L_mean), col = "#4c4cec", lwd=3)
plot(age,age,type = 'n', ylim = c(0, 1.64791664234), xlim = c(-51.45,2.45), ylab = 'Extinction rate', xlab = 'Ma' )
polygon(c(age, rev(age)), c(M_hpd_M95, rev(M_hpd_m95)), col = alpha("#e34a33",trans), border = NA)
lines(rev(age), rev(M_mean), col = "#e34a33", lwd=3)
plot(age,age,type = 'n', ylim = c(-1.37560032443, 0.483847001971), xlim = c(-51.45,2.45), ylab = 'Net diversification rate', xlab = 'Ma' )
abline(h=0,lty=2,col="darkred")
polygon(c(age, rev(age)), c(R_hpd_M95, rev(R_hpd_m95)), col = alpha("#504A4B",trans), border = NA)
lines(rev(age), rev(R_mean), col = "#504A4B", lwd=3)
plot(age,age,type = 'n', ylim = c(0, max(1/M_mean)), xlim = c(-51.45,2.45), ylab = 'Longevity (Myr)', xlab = 'Ma' )
lines(rev(age), rev(1/M_mean), col = "#504A4B", lwd=3)
n <- dev.off()